

//middlewares
app.use(cors())
app.use((req, res, next)=>{
    res.header("Access-Control-Allow-Origin", "*")
    app.use(cors())
    next()
})



//payment route

app.post("/payment", cors(), async (req, res)=>{
    let {name,amount, id, cpf } = req.body
    try{
        const payment = await stripe.paymentIntents.create({
            amount,
            currency:"BRL",
            description:name,
            payment_method:id,
            confirm:true
        })
        console.log("Payment", payment)
        res.json({
            message:"Paymeny Success",
            success:true
        })
    }catch(error){
        console.log("error",error)
        res.json({
            message:"payment Failed",
            success:false
        })
    }
})



